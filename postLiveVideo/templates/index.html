<!DOCTYPE HTML>
<html>
<head>
    <title>Filocalia Live Streaming</title>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function() {
            namespace = '/stream';
            var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);

            socket.on('start_stream_confirmation_server_event', function(msg) {
                $('#stream_input_data_log').html(JSON.stringify(msg));
            });

            socket.on('stream_status_server_event', function(msg) {
                $('#stream_status_log').html(msg.status);
            });

            socket.on('facebook_status_server_event', function(msg) {
                $('#facebook_status_log').html(msg.status);
            });

            $('form#start_stream').submit(function(event) {
                toggle = $('#toggle_stream')

                if (toggle.val() == "Start streaming") {
                  toggle.val("Stop streaming");
                  stream_data = {
                    youtube: $('#youtube_stream').is(':checked'),
                    facebook: $('#facebook_stream').is(':checked')
                  }
                  socket.emit('start_stream_client_event', {data: stream_data});
                }
                 else {
                  toggle.val("Start streaming");
                  socket.emit('stop_stream_client_event');
                }
                return false;
            });
        });
    </script>
</head>
<body>
    <h1>Filocalia Live Streaming</h1>
    <form id="start_stream" method="POST" action='#'>
        <input type="checkbox" name="youtube_stream" id="youtube_stream" value="Youtube" checked> Stream to Youtube<br>
        <input type="checkbox" name="facebook_stream" id="facebook_stream" value="Facebook" checked> Stream to Facebook<br>
        {% if session['streaming'] == False %}
             <input type="submit" id="toggle_stream" value="Start streaming">
         {% else %}
             <input type="submit" id="toggle_stream" value="Stop streaming">
         {% endif %}
    </form>
    <h2>Status:</h2>
    <div id="stream_input_data_log"></div>
    <div id="stream_status_log"></div>
    <div id="facebook_status_log"></div>
</body>
</html>
